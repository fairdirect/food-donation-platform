<?php

if(!$argv[1] || !$argv[2] || !$argv[3])
exit("Usage: php -f regions.php DBNAME DBUSER DBPASS\n");

/* create postgres connection */
try{
    $postgres = new PDO('pgsql:dbname=' . $argv[1] . ';host=localhost', $argv[2], $argv[3]);
    $postgres->exec("set names utf8");
} catch(Exception $e){
    exit($e->getMessage());
}

$postgres->exec('DELETE FROM epelia_regions');

/* prepare insert statements */
$regions_query = $postgres->prepare(
    "INSERT INTO epelia_regions(
            id, plz, name, country)
        VALUES(
            ?, ?, ?, ?
        )");

$inserted = 0;

$regions = array(
    array('01000','01944','Sachsen','DE'),
    array('01945','01999','Südost-Brandenburg','DE'),
    array('02000','02999','Sachsen','DE'),
    array('03000','03999','Südost-Brandenburg','DE'),
    array('04000','04599','Sachsen','DE'),
    array('04600','04639','Thüringen','DE'),
    array('04640','04889','Sachsen','DE'),
    array('04890','04999','Südost-Brandenburg','DE'),
    array('06000','06999','Sachsen Anhalt','DE'),
    array('07000','07999','Thüringen','DE'),
    array('08000','09999','Sachsen','DE'),
    array('10000','14399','Berlin','DE'),
    array('14400','14999','Nordwest-Brandenburg','DE'),
    array('15000','15999','Südost-Brandenburg','DE'),
    array('16000','16999','Nordwest-Brandenburg','DE'),
    array('17000','19272','Mecklenburg-Vorpommern','DE'),
    array('19273','19287','Niedersachsen','DE'),
    array('19288','19308','Mecklenburg-Vorpommern','DE'),
    array('19309','19356','Nordwest-Brandenburg','DE'),
    array('19357','19999','Mecklenburg-Vorpommern','DE'),
    array('20000','21038','Hamburg','DE'),
    array('21039','21199','Schleswig-Holstein','DE'),
    array('21200','21449','Niedersachsen','DE'),
    array('21450','21520','Schleswig-Holstein','DE'),
    array('21521','21523','Niedersachsen','DE'),
    array('21524','21529','Schleswig-Holstein','DE'),
    array('21530','21999','Niedersachsen','DE'),
    array('22000','22112','Hamburg','DE'),
    array('22113','23919','Schleswig-Holstein','DE'),
    array('23920','23999','Mecklenburg-Vorpommern','DE'),
    array('24000','25999','Schleswig-Holstein','DE'),
    array('26000','27497','Niedersachsen','DE'),
    array('27498','27498','Schleswig-Holstein','DE'),
    array('27499','27499','Hamburg','DE'),
    array('27500','27599','Bremen','DE'),
    array('27600','27999','Niedersachsen','DE'),
    array('28000','28789','Bremen','DE'),
    array('28790','29399','Niedersachsen','DE'),
    array('29400','29438','Sachsen-Anhalt','DE'),
    array('29439','31999','Niedersachsen','DE'),
    array('32000','33999','Nordrhein-Westfalen','DE'),
    array('34000','34329','Hessen','DE'),
    array('34330','34358','Niedersachsen','DE'),
    array('34359','34399','Hessen','DE'),
    array('34400','34439','Nordrhein-Westfalen','DE'),
    array('34440','34999','Hessen','DE'),
    array('35000','36399','Hessen','DE'),
    array('36400','36999','Thüringen','DE'),
    array('37000','37199','Niedersachsen','DE'),
    array('37200','37216','Hessen','DE'),
    array('37217','37234','Niedersachsen','DE'),
    array('37235','37299','Hessen','DE'),
    array('37300','37399','Thüringen','DE'),
    array('37400','37649','Niedersachsen','DE'),
    array('37650','37690','Nordrhein-Westfalen','DE'),
    array('37691','37695','Niedersachsen','DE'),
    array('37696','37696','Nordrhein-Westfalen','DE'),
    array('37697','38485','Niedersachsen','DE'),
    array('38486','38489','Sachsen-Anhalt','DE'),
    array('38490','38799','Niedersachsen','DE'),
    array('38800','39999','Sachsen-Anhalt','DE'),
    array('40000','48425','Nordrhein-Westfalen','DE'),
    array('48426','48564','Niedersachsen','DE'),
    array('48565','48999','Nordrhein-Westfalen','DE'),
    array('49000','49469','Niedersachsen','DE'),
    array('49470','49550','Nordrhein-Westfalen','DE'),
    array('49551','49999','Niedersachsen','DE'),
    array('50000','51597','Nordrhein-Westfalen','DE'),
    array('51598','51599','Rheinland-Pfalz','DE'),
    array('51600','53399','Nordrhein-Westfalen','DE'),
    array('53400','56999','Rheinland-Pfalz','DE'),
    array('57000','57499','Nordrhein-Westfalen','DE'),
    array('57500','57999','Rheinland-Pfalz','DE'),
    array('58000','59999','Nordrhein-Westfalen','DE'),
    array('60000','63699','Hessen','DE'),
    array('63700','63999','Nordbayern','DE'),
    array('64000','65550','Hessen','DE'),
    array('65551','65588','Rheinland-Pfalz','DE'),
    array('65589','65620','Hessen','DE'),
    array('65621','65626','Rheinland-Pfalz','DE'),
    array('65627','65628','Hessen','DE'),
    array('65629','65718','Rheinland-Pfalz','DE'),
    array('65719','65999','Hessen','DE'),
    array('66000','66999','Saarland','DE'),
    array('67000','67999','Rheinland-Pfalz','DE'),
    array('68000','68518','Baden-Würtemberg','DE'),
    array('68519','68525','Hessen','DE'),
    array('68526','68599','Baden-Würtemberg','DE'),
    array('68600','68699','Hessen','DE'),
    array('68700','69238','Baden-Würtemberg','DE'),
    array('69239','69241','Hessen','DE'),
    array('69242','69482','BadenWürtemberg','DE'),
    array('69483','69492','Hessen','DE'),
    array('69493','69502','Baden-Würtemberg','DE'),
    array('69503','69999','Hessen','DE'),
    array('70000','76699','Baden-Würtemberg','DE'),
    array('76700','76702','Rheinland-Pfalz','DE'),
    array('76703','76725','Baden-Würtemberg','DE'),
    array('76726','76999','Rheinland-Pfalz','DE'),
    array('77000','79999','Baden-Würtemberg','DE'),
    array('80000','87999','Südbayern','DE'),
    array('88000','88099','Baden-Würtemberg','DE'),
    array('88100','88146','Südbayern','DE'),
    array('88147','88148','Baden-Würtemberg','DE'),
    array('88149','88200','Südbayern','DE'),
    array('88201','89199','Baden-Würtemberg','DE'),
    array('89200','89499','Südbayern','DE'),
    array('89500','89999','Baden-Würtemberg','DE'),
    array('90000','96499','Nordbayern','DE'),
    array('96500','96999','Thüringen','DE'),
    array('97000','97870','Nordbayern','DE'),
    array('97871','97879','Baden-Würtemberg','DE'),
    array('97880','97899','Nordbayern','DE'),
    array('97900','97900','Baden-Würtemberg','DE'),
    array('97901','97915','Nordbayern','DE'),
    array('97916','97999','Baden-Würtemberg','DE'),
    array('98000','99999','Thüringen','DE'),
    array('00010','04999','Lazio','IT'),
    array('05000','06999','Umbria','IT'),
    array('07000','09999','Sardinia','IT'),
    array('10000','10999','Piedmont','IT'),
    array('12000','15999','Piedmont','IT'),
    array('28000','28999','Piedmont','IT'),
    array('11000','11999','Aosta Valley','IT'),
    array('16000','19999','Liguria','IT'),
    array('20000','27999','Lombardy','IT'),
    array('46000','46999','Lombardy','IT'),
    array('29000','29999','Emilia-Romagna','IT'),
    array('40000','44999','Emilia-Romagna','IT'),
    array('47000','48999','Emilia-Romagna','IT'),
    array('30000','32999','Veneto','IT'),
    array('35000','37999','Veneto','IT'),
    array('45000','45999','Veneto','IT'),
    array('33000','34999','Friuli-Venezia-Giulia','IT'),
    array('38000','39999','Südtirol','IT'),
    array('50000','59999','Toscana','IT'),
    array('60000','63999','Marche','IT'),
    array('64000','67999','Abruzzo','IT'),
    array('70000','74999','Apulia','IT'),
    array('75000','75999','Basilicata','IT'),
    array('85000','85999','Basilicata','IT'),
    array('80000','84999','Campania','IT'),
    array('86000','86999','Molise','IT'),
    array('87000','89999','Calabria','IT'),
    array('90000','98100','Sicily','IT'),
    array('1000','1699','Wien','AT'),
    array('2000','3999','Niederösterreich','AT'),
    array('5120','5149','Niederösterreich','AT'),
    array('4000','4999','Oberösterreich','AT'),
    array('5210','5299','Oberösterreich','AT'),
    array('5000','5119','Salzburg','AT'),
    array('5300','5771','Salzburg','AT'),
    array('6000','6699','Tirol','AT'),
    array('6700','6999','Vorarlberg','AT'),
    array('7000','7579','Burgenland','AT'),
    array('8000','8999','Staiermark','AT'),
    array('9000','9999','Kärnten','AT'),
    array('1000','1999','Südwestschweiz','CH'),
    array('2000','2999','Nordwestschweiz','CH'),
    array('3000','3999','Region Bern','CH'),
    array('4000','4999','Region Basel','CH'),
    array('5000','5999','Region Aargau','CH'),
    array('6000','6999','Zentralschweiz/ Tessin','CH'),
    array('7000','7999','Region Graubünden','CH'),
    array('8000','8999','Region Zürich','CH'),
    array('9000','9999','Ostschweiz','CH'),
    array('01001','01510','Basque','ES'),
    array('20001','20870','Basque','ES'),
    array('48001','48998','Basque','ES'),
    array('03000','03870','Valencian Community','ES'),
    array('12001','12609','Valencian Community','ES'),
    array('46000','46989','Valencian Community','ES'),
    array('06001','06980','Extremadura','ES'),
    array('10001','10991','Extremadura','ES'),
    array('07000','07870','Balearic Islands','ES'),
    array('22001','22889','Aragon','ES'),
    array('44001','44793','Aragon','ES'),
    array('50001','50840','Aragon','ES'),
    array('26001','26589','La Rioja','ES'),
    array('28000','28991','Madrid','ES'),
    array('30000','30893','Murcia','ES'),
    array('31001','31890','Navarra','ES'),
    array('33000','33996','Asturias','ES'),
    array('35000','35660','Canary Islands','ES'),
    array('38001','38917','Canary Islands','ES'),
    array('51001','51080','Ceuta','ES'),
    array('52000','52080','Melilla','ES'),
    array('10001','19098','Harju','EE'),
    array('74001','76992','Harju','EE'),
    array('20001','43408','Ida-Viru','EE'),
    array('44001','49604','Lääne Viru & Jögeva','EE'),
    array('50050','62511','Tartu','EE'),
    array('63001','68716','Põlva, Vöru & Valga','EE'),
    array('69001','74000','Viljandi, Järva & Rapla','EE'),
    array('76993','79891','Viljandi, Järva & Rapla','EE'),
    array('80001','88442','Pärmu','EE'),
    array('90101','94791','Lääne, Hiiu & Saaremaa','EE'),
    array('1116','3302','Mosambik','MZ'),  
    array('1110','2115','Kap Verde','CV'), 
    array('97600','97680','Mayotte','FR'), 
    array('1000','9183','Tunesien','TN'),  
    array('0000','9986','Südafrika','ZA'),     
    array('H103','S415','Swasiland','SZ'),   
    array('023401','982112','Nigeria','NG'),
    array('101','513','Madagaskar','MG'),   
    array('23102','75999','Tansania','TZ'), 
    array('1000','7999','Äthiophien','ET'),   
    array('00906','90409','Kenia','KE'), 
//    array('LV-1000','LV-5740','Lettland','LV'),    
    array('01001','99425','Litauen','LT'),
//    array('00-001','99-440','Polen','PL'), 
    array('1000','9600','Slowenien','SI'), 
    array('10000','89999','Griechenland','GR'), 
    array('1000','9999','Bulgarien','BG'),  
    array('4000','9999','Albanien','AB'),   
    array('210000','247150','Weißrussland','BY'), 
    array('10000','49999','Kroatien','HR'),
    array('10000','79999','Tschechien','CZ'),
    array('10000','73999','Rumänien','RO'),
    array('1000','9999','Ungarn','HU'),
    array('01001','99999','Slowakei','SK'),
    array('00000','99999','Ukraine','UA'),
    array('81000','85999','Montenegro','ME'),
    array('70000','76216','Bosnien und Herzegowina','BA'),
    array('1000','7503','Mazedonien','MK'),
    array('2000','7344','Moldawien','MD'),
    array('10000','70099','Kosovo','XK'),
    array('1000','1299','Nordholland','NL'),
    array('1400','2100','Nordholland','NL'),
    array('1300','1399','Provinz Flevoland','NL'),
    array('8200','8399','Provinz Flevoland','NL'),
    array('3800','3899','Provinz Flevoland','NL'),
    array('2200','3399','Provinz Südholland','NL'),
    array('3400','3999','Provinz Utrecht','NL'),
    array('4000','4199','Provinz Gelderland','NL'),
    array('6500','7399','Provinz Gelderland','NL'),
    array('4200','4299','Provinz Nordbrabant','NL'),
    array('4600','5799','Provinz Nordbrabant','NL'),
    array('4300','4599','Provinz Zeeland','NL'),
    array('5800','6499','Provinz Limburg','NL'),
    array('7400','7799','Provinz Overijssel','NL'),
    array('8100','8199','Provinz Overijssel','NL'),
    array('7800','7999','Provinz Drente','NL'),
    array('9300','9599','Provinz Drente','NL'),
    array('8400','9299','Provinz Friesland','NL'),
    array('9600','9999','Provinz Groningen','NL'),
    array('1000','1212','Region Brüssel','BE'),
    array('1931','1950','Region Brüssel','BE'),
    array('1500','1939','Flandern','BE'),
    array('1951','3999','Flandern','BE'),
    array('4000','7970','Wallonische Region','BE'),
    array('78000','79999','Ille de France','FR'),
    array('91000','95999','Ille de France','FR'),
    array('01000','01999','Auvergne Rhône Alpas','FR'),
    array('03000','00799','Auvergne Rhône Alpas','FR'),
    array('09000','09999','Auvergne Rhône Alpas','FR'),
    array('15000','15999','Auvergne Rhône Alpas','FR'),
    array('26000','27999','Auvergne Rhône Alpas','FR'),
    array('38000','38999','Auvergne Rhône Alpas','FR'),
    array('42000','43999','Auvergne Rhône Alpas','FR'),
    array('63000','63999','Auvergne Rhône Alpas','FR'), 
    array('69000','69999','Auvergne Rhône Alpas','FR'),
    array('74000','75999','Auvergne Rhône Alpas','FR'),
    array('83000','84999','Auvergne Rhône Alpas','FR'),
    array('16000','17999','Nouvelle Aquitaine','FR'),
    array('23000','24999','Nouvelle Aquitaine','FR'),
    array('33000','33999','Nouvelle Aquitaine','FR'),
    array('40000','40999','Nouvelle Aquitaine','FR'),
    array('47000','47999','Nouvelle Aquitaine','FR'),
    array('64000','64999','Nouvelle Aquitaine','FR'),
    array('80000','80999','Nouvelle Aquitaine','FR'),
    array('86000','87999','Nouvelle Aquitaine','FR'),
    array('02000','02999','Hauts de France','FR'),
    array('60000','60999','Hauts de France','FR'),
    array('62000','62999','Hauts de France','FR'),
    array('13000','13999','Provence Alpes-Cote d’ Azur','FR'),
    array('83000','84999','Provence Alpes-Cote d’ Azur','FR'),
    array('22000','22999','Bretagne','FR'),
    array('30000','30999','Bretagne','FR'),
    array('35000','35999','Bretagne','FR'),
    array('56000','56999','Bretagne','FR'),
    array('18000','19999','Centre Val de Loire','FR'),
    array('29000','29999','Centre Val de Loire','FR'),
    array('36000','37999','Centre Val de Loire','FR'),
    array('41000','41999','Centre Val de Loire','FR'),
    array('45000','45999','Centre Val de Loire','FR'),
    array('44000','44999','Pays de la Loire','FR'),
    array('53000','53999','Pays de la Loire','FR'),
    array('72000','73999','Pays de la Loire','FR'),
    array('85000','85999','Pays de la Loire','FR'),
    array('08000','08999','Grand Est','FR'),
    array('10000','10999','Grand Est','FR'),
    array('51000','52999','Grand Est','FR'),
    array('54000','55999','Grand Est','FR'),
    array('57000','57999','Grand Est','FR'),
    array('67000','68999','Grand Est','FR'),
    array('88000','88999','Grand Est','FR'),
    array('14000','14999','Normandie','FR'),
    array('28000','28999','Normandie','FR'),
    array('50000','50999','Normandie','FR'),
    array('61000','61999','Normandie','FR'),
    array('25000','25999','Borgogne Franche Comté','FR'),
    array('39000','39999','Borgogne Franche Comté','FR'),
    array('58000','58999','Borgogne Franche Comté','FR'),
    array('70000','71999','Borgogne Franche Comté','FR'),
    array('89000','90999','Borgogne Franche Comté','FR'),
    array('11000','12999','L`Occitanie','FR'),
    array('31000','32999','L`Occitanie','FR'),
    array('34000','34999','L`Occitanie','FR'),
    array('46000','46999','L`Occitanie','FR'),
    array('48000','48999','L`Occitanie','FR'),
    array('65000','66999','L`Occitanie','FR'),
    array('81000','82999','L`Occitanie','FR'),
    array('20000','21999','Corse','FR'),
    array('97100','97199','Guadeloupe','FR'),
    array('97133','97133','Saint Barthélemy','FR'),
    array('97150','97150','Saint Martin','FR'),
    array('97200','97299','Martinique','FR'),
    array('97300','97399','French Guiana','FR'),
    array('97400','97499','La Réunion','FR'),
    array('97500','97500','Saint Pierre & Miquelon','FR'),
    array('98600','98699','Wallis & Futuna','FR'),
    array('98700','98798','French Polynesia','FR'),
    array('98799','98799','Clipperton Island','FR'),
    array('98800','98899','New Caledonia','FR')                  
);

foreach($regions as $region) {
    for ($i = intval($region[0]); $i <= intval($region[1]); $i++) {
        if (in_array($region[3], array('DE', 'IT', 'ES', 'FR', 'SK', 'UA'))) { // countries with leading zeros
            $plz = str_pad($i, 5, '0', STR_PAD_LEFT);
        } else {
            $plz = $i;
        }
        $regions_query->execute(array($plz . '_' . $region[3], $plz, $region[2], $region[3]));
        $inserted++;
    }
}

echo 'Inserted ' . $inserted . " PLZ\n";


$countries = array(
    array('DE', 'Deutschland', '049'),
    array('AT', 'Österreich', '043'),
    array('CH', 'Schweiz', '041'),
    array('BE', 'Belgien', '032'),
    array('IT', 'Italien', '039'),
    array('DK', 'Dänemark', '045'),
    array('FR', 'Frankreich', '033'),
    array('LT', 'Litauen', '0370'),
    array('LV', 'Lettland', '0371'),
    array('EE', 'Estland', '0372'),
    array('LU', 'Luxemburg', '0352'),
    array('NL', 'Niederlande', '031'),
    array('PL', 'Polen', '048'),
    array('SE', 'Schweden', '046'),
    array('FI', 'Finnland', '0358'),
    array('NO', 'Norwegen', '047'),
    array('RU', 'Russland', '007'),
    array('RO', 'Rumänien', '040'),
    array('GR', 'Griechenland', '030'),
    array('GB', 'Vereinigtes Königreich', '044'),
    array('ES', 'Spanien', '034'),
    array('SK', 'Slowakei', '0421'),
    array('LI', 'Liechtenstein', '0423'),
    array('CZ', 'Tschechien', '0420'),
    array('BG', 'Bulgarien', '0359'),
    array('US', 'USA', '001'),
    array('AB', 'Albanien', '0355'),
    array('ME', 'Montenegro', '0382') ,
    array('ET', 'Äthiophien', '0251'),
    array('MD', 'Moldawien', '0373'),
    array('BA', 'Bosnien und Herzegowina', '0387'),
    array('UA', 'Ukraine', '0380'),
    array('RS', 'Serbien', '0381'), 
    array('MK', 'Mazedonien', '0389'),
    array('HR', 'Kroatien', '0385'),
    array('HU', 'Ungarn', '036'),
    array('MG', 'Madagaskar', '0261'),
    array('TZ', 'Tansania', '0255'),
    array('KE', 'Kenia', '0254'),
    array('NG', 'Nigeria', '0234'),
    array('US', 'USA', '001'),
    array('SZ', 'Swasiland', '000'),
    array('ZA', 'Südafrika', '027'),   
    array('TN', 'Tunesien', '021'),
    array('YT', 'Mayotte', '0262'),  
    array('CV', 'Kap Verde', '0238'),
    array('MZ', 'Mosambik', '0258'),
    array('UG', 'Uganda', '0256'),
    array('SI', 'Slowenien', '0386'),
    array('BY', 'Weißrussland', '0375'),
    array('XK', 'Kosovo', '0383')                         
);

exit("done\n");
